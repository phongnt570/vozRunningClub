{% load track_custom_utils %}

<table class="table table-striped table-hover">
    <thead>
    <tr>
        <th>Rank</th>
        <th>Strava</th>
        <th>Voz</th>
        <th class="text-end">Runs</th>
        <th class="text-end">Avg. Pace</th>
        <th class="text-end">Distance</th>
        <th class="text-end">Registration</th>
        <th class="text-end">Missing</th>
        <th class="text-end">Donation</th>
    </tr>
    </thead>
    <tbody>
    {% for weekly_progress in data %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>
                {% if club_status %}
                    {% if weekly_progress.user.profile.strava_club_joined %}
                        <span class="text-success" title="Đã tham gia Strava Club">
                            <i class="fas fa-check-circle"></i>
                        </span>
                    {% else %}
                        <span class="text-danger"
                              title="Chưa tham gia Strava Club">
                            <i class="fas fa-times-circle"></i>
                        </span>
                    {% endif %}
                    &nbsp;
                {% endif %}
                <a href="https://strava.com/athletes/{{ user_2_strava_id|get_item:weekly_progress.user.id }}"
                   target="_blank"
                   class="text-decoration-none fw-semibold">
                    {{ weekly_progress.user.get_full_name }}
                </a>
            </td>
            <td>{{ weekly_progress.user.profile.voz_name }}</td>
            <td class="text-end">{{ weekly_progress.runs }}</td>
            <td class="text-end">{{ weekly_progress.average_pace|pace_format }}/km</td>
            <td class="text-end">{{ weekly_progress.distance|floatformat:1 }} km</td>
            <td class="text-end">
                {% if weekly_progress.registered_mileage.distance > 0 %}
                    {{ weekly_progress.registered_mileage.distance|floatformat:0 }} km
                {% else %}
                    <span class="text-secondary">--</span>
                {% endif %}
            </td>
            <td class="text-end">{{ weekly_progress|missing_distance_str }}</td>
            <td class="text-end">
                {% if weekly_progress.registered_mileage.distance == 0 %}
                    <span class="text-secondary">--</span>
                {% else %}
                    {{ weekly_progress.donation|floatformat:"g" }} ₫
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>